{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/macbookpro/Projects/web/dipongo_app/store.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useContext, ReactNode, useState, useEffect } from \"react\";\nimport { useRouter } from 'next/router';\nimport jwt_decode from \"jwt-decode\";\nimport axios from \"axios\";\nimport { URL } from \"./urlapi\";\nimport { message } from \"antd\";\nimport useSocket from \"./useSocket\";\nvar authContextDefaultValues = {\n  session: null,\n  updateSession: function updateSession() {},\n  deleteSession: function deleteSession() {},\n  initSession: function initSession() {}\n};\nvar AuthContext = /*#__PURE__*/createContext(authContextDefaultValues);\nexport function useAuth() {\n  _s();\n\n  return useContext(AuthContext);\n}\n\n_s(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport function AuthProvider(_ref) {\n  _s2();\n\n  var children = _ref.children;\n\n  var getCookie = function getCookie(name) {\n    if (true) {\n      var re = new RegExp(name + \"=([^;]+)\");\n      var value = re.exec(document.cookie);\n      return value != null ? unescape(value[1]) : null;\n    }\n  };\n\n  var setCookie = function setCookie(name, value) {\n    if (true) {\n      var expires = \"\";\n      var date = new Date();\n      date.setTime(date.getTime() + 365 * 24 * 60 * 60 * 1000);\n      expires = \"; expires=\" + date.toUTCString();\n      document.cookie = name + \"=\" + (value || \"\") + expires + \"; path=/\";\n    }\n  };\n\n  var _useState = useState(null),\n      session = _useState[0],\n      setSession = _useState[1];\n\n  var updateSession = function updateSession(s) {\n    console.log('updated');\n\n    if (true) {\n      if (s.running_session !== undefined && s.running_session !== null) {\n        localStorage.setItem(\"session\", JSON.stringify(s.running_session));\n        setSession({\n          session: s.running_session\n        });\n      } else {\n        localStorage.setItem(\"session\", null);\n        router.push('/onboard').then(function (r) {});\n      }\n    }\n  };\n\n  var deleteSession = function deleteSession() {\n    if (true) {\n      setSession(null);\n      var token = localStorage.getItem(\"token\");\n      localStorage.removeItem(\"user\");\n      localStorage.removeItem(\"token\");\n      setCookie(\"token\", \"null\");\n      localStorage.removeItem(\"session\");\n\n      if (token !== null) {\n        axios.get(URL + '/api/leave/game', {\n          headers: {\n            'Authorization': 'Bearer ' + token\n          }\n        }).then(function (result) {\n          router.push('/').then(function (res) {});\n        })[\"catch\"](function (error) {\n          router.push('/').then(function (res) {});\n        });\n      } else {\n        router.push('/').then(function (res) {});\n      }\n    }\n  };\n\n  var initSession = function initSession(data) {\n    if (true) {\n      if (data.running_session === null) {\n        localStorage.setItem(\"session\", null);\n      } else {\n        localStorage.setItem(\"session\", JSON.stringify(data.running_session));\n      }\n\n      localStorage.setItem(\"token\", data.token);\n      setCookie(\"token\", data.token);\n      localStorage.setItem(\"user\", JSON.stringify(data.user));\n    }\n\n    setSession(data);\n\n    if (data.running_session !== null) {\n      router.push('/roadmap');\n    } else {\n      router.push('/onboard');\n    }\n  };\n\n  var clearStorage = function clearStorage() {\n    localStorage.removeItem(\"user\");\n    localStorage.removeItem(\"token\");\n    setCookie(\"token\", null);\n    localStorage.removeItem(\"session\");\n  };\n\n  var value = {\n    session: session,\n    updateSession: updateSession,\n    deleteSession: deleteSession,\n    initSession: initSession\n  };\n  var isAuth = false;\n  var publicPath = ['/', '/login', '/signin'];\n  var router = useRouter();\n  useEffect(function () {\n    if (true) {\n      isAuth = localStorage.getItem(\"user\") !== null;\n\n      if (!isAuth) {\n        if (!publicPath.includes(router.pathname)) {\n          deleteSession();\n          router.push('/');\n        } else {\n          deleteSession();\n          router.push('/');\n        }\n      } else {\n        var token = localStorage.getItem(\"token\");\n        var deT = jwt_decode(token);\n        var exp = deT.exp;\n        var time = Date.now() / 1000;\n\n        if (time > exp) {\n          router.push('/login');\n        } else {\n          axios.get(URL + '/api/user/info', {\n            headers: {\n              'Authorization': 'Bearer ' + token\n            }\n          }).then(function (result) {\n            if (result.data.data.running_session !== null) {\n              setSession({\n                session: result.data.data.running_session\n              });\n              localStorage.setItem(\"session\", JSON.stringify(result.data.data.running_session));\n\n              if (router.pathname === '/') {\n                clearStorage();\n              } else {\n                if (router.pathname.includes('onboard')) {\n                  router.push('/roadmap');\n                }\n              }\n            } else {\n              setSession({\n                session: null\n              });\n              localStorage.removeItem(\"session\");\n              router.push('/onboard');\n            }\n          })[\"catch\"](function (error) {\n            console.log(error);\n\n            if (error.response) {\n              if (error.response.data.code === \"invalid_jwt_token\") {\n                deleteSession();\n                router.push('/');\n              } //message.warning(error.response.data.message)\n\n            } else if (error.request) {\n              console.log(error.request);\n            } else {\n              console.log('Error', error);\n            }\n          });\n        }\n      }\n    }\n  }, []);\n\n  var _useState2 = useState([]),\n      messages = _useState2[0],\n      setMessages = _useState2[1];\n\n  var _useState3 = useState([]),\n      message = _useState3[0],\n      setMessage = _useState3[1];\n\n  var socket = useSocket();\n  useEffect(function () {\n    if (true) {\n      if (socket) {\n        socket.emit('user_online', {\n          token: localStorage.getItem(\"token\")\n        });\n      }\n    }\n  }, [socket]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n      value: value,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n}\n\n_s2(AuthProvider, \"zbRCXWfWhhH6m4yT8ebrQXRQYz8=\", false, function () {\n  return [useRouter, useSocket];\n});\n\n_c = AuthProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["/Users/macbookpro/Projects/web/dipongo_app/store.js"],"names":["createContext","useContext","ReactNode","useState","useEffect","useRouter","jwt_decode","axios","URL","message","useSocket","authContextDefaultValues","session","updateSession","deleteSession","initSession","AuthContext","useAuth","AuthProvider","children","getCookie","name","re","RegExp","value","exec","document","cookie","unescape","setCookie","expires","date","Date","setTime","getTime","toUTCString","setSession","s","console","log","running_session","undefined","localStorage","setItem","JSON","stringify","router","push","then","r","token","getItem","removeItem","get","headers","result","res","error","data","user","clearStorage","isAuth","publicPath","includes","pathname","deT","exp","time","now","response","code","request","messages","setMessages","setMessage","socket","emit"],"mappings":"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","sourcesContent":["import {createContext, useContext, ReactNode, useState, useEffect} from \"react\";\nimport { useRouter } from 'next/router'\nimport jwt_decode from \"jwt-decode\";\nimport axios from \"axios\";\nimport {URL} from \"./urlapi\";\nimport {message} from \"antd\";\nimport useSocket from \"./useSocket\";\n\nconst authContextDefaultValues = {\n    session: null,\n    updateSession: () => {},\n    deleteSession: () => {},\n    initSession: () => {},\n};\nconst AuthContext = createContext(authContextDefaultValues);\n\nexport function useAuth() {\n    return useContext(AuthContext);\n}\n\nexport function AuthProvider({ children }) {\n\n\n    const getCookie = (name) =>\n    {\n        if (typeof window !== \"undefined\"){\n            var re = new RegExp(name + \"=([^;]+)\");\n            var value = re.exec(document.cookie);\n            return (value != null) ? unescape(value[1]) : null;\n        }\n\n    }\n\n    const setCookie = (name,value)=> {\n        if (typeof window !== \"undefined\"){\n            var expires = \"\";\n            var date = new Date();\n            date.setTime(date.getTime() + (365*24*60*60*1000));\n            expires = \"; expires=\" + date.toUTCString();\n            document.cookie = name + \"=\" + (value || \"\")  + expires + \"; path=/\";\n        }\n    }\n    const [session, setSession] = useState(null);\n    const updateSession = (s) => {\n        console.log('updated')\n        if (typeof window !== \"undefined\"){\n            if(s.running_session !== undefined && s.running_session!==null){\n                localStorage.setItem(\"session\",JSON.stringify(s.running_session));\n                setSession({session: s.running_session});\n            }\n            else{\n                localStorage.setItem(\"session\",null)\n                router.push('/onboard').then((r)=>{})\n            }\n\n        }\n    };\n    const deleteSession = () => {\n        if (typeof window !== \"undefined\"){\n            setSession(null);\n            const token = localStorage.getItem(\"token\")\n            localStorage.removeItem(\"user\");\n            localStorage.removeItem(\"token\");\n            setCookie(\"token\",\"null\")\n            localStorage.removeItem(\"session\");\n            if(token!== null){\n                axios.get(URL + '/api/leave/game', {\n                    headers: {\n                        'Authorization': 'Bearer ' + token\n                    }\n                }).then((result)=>{\n                    router.push('/').then((res)=>{})\n                }).catch((error)=>{\n                    router.push('/').then((res)=>{})\n                });\n            }\n            else{\n                router.push('/').then((res)=>{})\n            }\n\n\n        }\n\n\n    };\n    const initSession = (data) => {\n        if (typeof window !== \"undefined\"){\n            if(data.running_session === null){\n                localStorage.setItem(\"session\",null);\n            }else{\n                localStorage.setItem(\"session\",JSON.stringify(data.running_session));\n            }\n            localStorage.setItem(\"token\",data.token);\n            setCookie(\"token\",data.token);\n            localStorage.setItem(\"user\",JSON.stringify(data.user));\n\n        }\n        setSession(data);\n        if(data.running_session !== null){\n           router.push('/roadmap')\n        }\n        else{\n           router.push('/onboard')\n        }\n    };\n    const clearStorage = () => {\n        localStorage.removeItem(\"user\");\n        localStorage.removeItem(\"token\");\n        setCookie(\"token\",null)\n        localStorage.removeItem(\"session\");\n    }\n    const value = {\n        session,\n        updateSession,\n        deleteSession,\n        initSession\n    };\n    let isAuth = false;\n    const publicPath = ['/','/login','/signin'];\n    const router = useRouter()\n    useEffect(() => {\n        if (typeof window !== \"undefined\"){\n            isAuth  = localStorage.getItem(\"user\") !== null;\n\n           if(!isAuth){\n               if(!publicPath.includes(router.pathname)){\n                   deleteSession();\n                   router.push('/')\n               }else{\n                   deleteSession();\n                   router.push('/')\n               }\n           }\n           else{\n\n               let token = localStorage.getItem(\"token\");\n               let deT = jwt_decode(token);\n               let exp = deT.exp;\n               let time = Date.now()/1000;\n               if(time > exp){\n                   router.push('/login')\n               }\n               else\n                   {\n\n                       axios.get(URL + '/api/user/info', {\n                           headers: {\n                               'Authorization': 'Bearer ' + token\n                           }\n                       }).then((result)=>{\n                          if(result.data.data.running_session !== null){\n                              setSession({session: result.data.data.running_session})\n                              localStorage.setItem(\"session\",JSON.stringify(result.data.data.running_session))\n\n                              if(router.pathname === '/'){\n                                  clearStorage();\n                              }\n                          else{\n                                  if(router.pathname.includes('onboard')){\n                                      router.push('/roadmap')\n                                  }\n                              }\n\n                          }\n                          else{\n                              setSession({session: null})\n                              localStorage.removeItem(\"session\")\n                              router.push('/onboard')\n                          }\n\n                       }).catch((error)=>{\n                           console.log(error)\n                           if (error.response) {\n                               if(error.response.data.code === \"invalid_jwt_token\"){\n                                   deleteSession();\n                                   router.push('/')\n                               }\n                               //message.warning(error.response.data.message)\n                           } else if (error.request) {\n                               console.log(error.request)\n                           } else {\n                               console.log('Error', error)\n                           }\n\n                       });\n               }\n           }\n        }\n\n    }, [])\n    const [messages, setMessages] = useState([]);\n    const [message, setMessage] = useState([]);\n    const socket = useSocket();\n\n    useEffect(() => {\n        if (typeof window !== \"undefined\"){\n            if (socket) {\n                socket.emit('user_online', {token: localStorage.getItem(\"token\")});\n            }\n        }\n\n\n    }, [socket]);\n\n    return (\n        <>\n            <AuthContext.Provider value={value}>\n                {children}\n            </AuthContext.Provider>\n        </>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}